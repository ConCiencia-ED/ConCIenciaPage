<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ConCiencia | Videos Cortos</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>

:root{
  --primary:#8f6fff;
  --primary2:#6a54ff;
  --bg1:#f6f3ff;
  --bg2:#ebe6ff;
  --danger:#ff4d6d;
  --glass:rgba(255,255,255,0.55);
  --glass-border:rgba(143,111,255,0.18);
}

*{margin:0;padding:0;box-sizing:border-box;}

body{
  font-family:Poppins;
  height:100vh;
  overflow:hidden;
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
}

/* HEADER */
header{
  background:linear-gradient(90deg,var(--primary),var(--primary2));
  color:white;
  text-align:center;
  padding:15px;
  font-size:22px;
  font-weight:600;
  letter-spacing:1px;
  position:relative;
}

/* BOTON VOLVER EN HEADER */
.headerBack{
  position:absolute;
  left:18px;
  top:50%;
  transform:translateY(-50%);
  background:rgba(255,255,255,0.2);
  border:none;
  color:white;
  width:38px;
  height:38px;
  border-radius:50%;
  cursor:pointer;
  font-size:15px;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:0.25s;
  backdrop-filter:blur(4px);
}
.headerBack:hover{
  background:rgba(255,255,255,0.35);
  transform:translateY(-50%) scale(1.1);
}

/* ===================== MENU ===================== */
.menu{
  height:calc(100vh - 60px);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:30px;
  padding:30px;
}

.menuTitle{
  text-align:center;
}

.menuTitle h2{
  font-size:26px;
  font-weight:700;
  color:#3c2f7a;
  margin-bottom:6px;
}

.menuTitle p{
  font-size:14px;
  color:#999;
}

.emociones{
  display:flex;
  gap:18px;
  flex-wrap:wrap;
  justify-content:center;
}

.emocion{
  background:white;
  padding:22px 36px;
  border-radius:22px;
  font-size:15px;
  font-weight:500;
  cursor:pointer;
  box-shadow:0 8px 24px rgba(143,111,255,0.15);
  transition:0.3s;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:10px;
  min-width:110px;
  color:#444;
  border:2px solid transparent;
}

.emocion i{
  font-size:28px;
  color:var(--primary);
  transition:0.3s;
}

.emocion:hover{
  transform:translateY(-6px) scale(1.05);
  background:linear-gradient(135deg,var(--primary),var(--primary2));
  color:white;
  border-color:transparent;
  box-shadow:0 14px 32px rgba(143,111,255,0.3);
}

.emocion:hover i{
  color:white;
}

/* ===================== REELS ===================== */
.reels{
  display:none;
  height:calc(100vh - 60px);
  padding:25px;
}

.layout{
  display:flex;
  gap:30px;
  height:100%;
  justify-content:center;
  align-items:center;
}

/* FLECHAS SCROLL */
.scrollBtns{
  display:flex;
  flex-direction:column;
  gap:14px;
  align-items:center;
}

.scrollBtn{
  width:46px;
  height:46px;
  border-radius:50%;
  border:none;
  background:white;
  color:var(--primary);
  font-size:17px;
  cursor:pointer;
  box-shadow:0 5px 18px rgba(143,111,255,0.22);
  transition:0.25s;
  display:flex;
  align-items:center;
  justify-content:center;
}

.scrollBtn:hover{
  background:var(--primary);
  color:white;
  transform:scale(1.12);
}

.scrollBtn:disabled{
  opacity:0.3;
  cursor:default;
  transform:none !important;
}

/* VIDEO BOX */
.videoBox{
  width:300px;
  height:520px;
  border-radius:28px;
  overflow:hidden;
  background:black;
  box-shadow:0 20px 50px rgba(106,84,255,0.3);
  position:relative;
  transition:width 0.3s ease, height 0.3s ease, opacity 0.3s ease, transform 0.3s ease;
  flex-shrink:0;
}

.videoBox.grande{
  width:460px;
  height:660px;
}

.videoBox video{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* CONTROLES SOBRE VIDEO */
.topControls{
  position:absolute;
  top:12px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  z-index:10;
}

.videoOverlay{
  position:absolute;
  bottom:14px;
  left:50%;
  transform:translateX(-50%);
  z-index:10;
}

.iconBtn{
  width:42px;
  height:42px;
  border-radius:50%;
  border:none;
  background:rgba(255,255,255,0.22);
  backdrop-filter:blur(8px);
  color:white;
  font-size:15px;
  cursor:pointer;
  box-shadow:0 4px 12px rgba(0,0,0,0.18);
  transition:0.25s;
  display:flex;
  align-items:center;
  justify-content:center;
}

.iconBtn:hover{
  background:rgba(255,255,255,0.4);
  transform:scale(1.12);
}

/* PANEL */
.infoPanel{
  width:340px;
  background:var(--glass);
  backdrop-filter:blur(12px);
  padding:22px;
  border-radius:24px;
  border:1px solid var(--glass-border);
  display:flex;
  flex-direction:column;
  gap:14px;
  box-shadow:0 10px 40px rgba(143,111,255,0.1);
}

.infoPanel h3{ color:#3c2f7a; font-size:16px; }
.infoPanel .desc{ font-size:13px; color:#888; margin-top:-8px; }

/* INDICADOR */
.videoIndicator{ display:flex; gap:6px; justify-content:center; }
.dot{ width:8px; height:8px; border-radius:50%; background:#d0c8ff; transition:0.3s; }
.dot.active{ background:var(--primary); width:22px; border-radius:4px; }

/* COMENTARIOS */
.comentariosLabel{
  font-size:11px;
  font-weight:600;
  color:var(--primary);
  text-transform:uppercase;
  letter-spacing:0.6px;
  margin-bottom:8px;
}

.comentarios{
  background:white;
  border-radius:14px;
  padding:10px;
  height:175px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:6px;
  scrollbar-width:thin;
  scrollbar-color:var(--primary) transparent;
}

.sinComents{ color:#ccc; font-size:13px; text-align:center; margin:auto; }

.coment{
  background:#f3f0ff;
  padding:8px 12px;
  border-radius:10px;
  cursor:pointer;
  font-size:13px;
  transition:0.2s;
  line-height:1.4;
}
.coment:hover{ background:#ece7ff; }
.coment.selected{ outline:2px solid var(--primary); background:#ece7ff; }

.comentActions{ margin-top:7px; display:flex; gap:7px; }
.comentActions button{
  flex:1; border:none; padding:5px; border-radius:8px;
  cursor:pointer; background:var(--primary); color:white;
  font-size:12px; font-family:Poppins; transition:0.2s;
}
.comentActions button:hover{ opacity:0.82; }

.comentInput{
  padding:9px 14px;
  border-radius:12px;
  border:1.5px solid #e0d9ff;
  background:#faf8ff;
  outline:none;
  font-family:Poppins;
  font-size:13px;
  width:100%;
  transition:0.2s;
}
.comentInput:focus{ border-color:var(--primary); }

/* VOLUMEN */
.volumen{ display:flex; align-items:center; gap:10px; }
.volumen input{ flex:1; accent-color:var(--primary); }

.volBtn{
  width:34px; height:34px; border-radius:50%; border:none;
  background:white; color:var(--primary); font-size:13px; cursor:pointer;
  box-shadow:0 3px 10px rgba(143,111,255,0.18); transition:0.2s;
  display:flex; align-items:center; justify-content:center;
}
.volBtn:hover{ background:var(--primary); color:white; transform:scale(1.1); }

</style>
</head>

<body>

<header>
  <!-- Volver a menuayuda.html -->
  <button class="headerBack" onclick="location.href='menuayuda.html'" title="Volver">
    <i class="fa-solid fa-arrow-left"></i>
  </button>
  ConCiencia
</header>

<!-- ===== MENU EMOCIONES ===== -->
<div class="menu" id="menu">

  <div class="menuTitle">
    <h2>¿Qué estás sintiendo?</h2>
    <p>Elige una emoción para ver videos relacionados</p>
  </div>

  <div class="emociones">
    <div class="emocion" onclick="iniciar()">
      <i class="fa-regular fa-face-laugh-beam"></i>
      Alegria
    </div>
    <div class="emocion" onclick="iniciar()">
      <i class="fa-regular fa-face-sad-tear"></i>
      Tristeza
    </div>
    <div class="emocion" onclick="iniciar()">
      <i class="fa-regular fa-face-angry"></i>
      Enojo
    </div>
    <div class="emocion" onclick="iniciar()">
      <i class="fa-regular fa-face-grimace"></i>
      Ansiedad
    </div>
    <div class="emocion" onclick="iniciar()">
      <i class="fa-solid fa-bolt"></i>
      Motivacion
    </div>
  </div>

</div>

<!-- ===== REELS ===== -->
<div class="reels" id="reels"></div>

<script>

const videos=[
  "video-1.mp4",
  "video-2.mp4",
  "video-3.mp4"
];

let index=0;
let volumenActual=1;
let comentarioSeleccionado=null;
let videoGrande=false;
let pausado=false;

/* ---- INIT ---- */
function iniciar(){
  document.getElementById("menu").style.display="none";
  document.getElementById("reels").style.display="block";
  cargar();
}

function cargar(){
  const id="video"+index;
  const data=getComents(id);
  const dots=videos.map((_,i)=>`<div class="dot${i===index?' active':''}"></div>`).join("");

  document.getElementById("reels").innerHTML=`
  <div class="layout">

    <div class="scrollBtns">
      <button class="scrollBtn" onclick="cambiar(-1)" ${index===0?'disabled':''}>
        <i class="fa-solid fa-chevron-up"></i>
      </button>
      <button class="scrollBtn" onclick="cambiar(1)" ${index===videos.length-1?'disabled':''}>
        <i class="fa-solid fa-chevron-down"></i>
      </button>
    </div>

    <div class="videoBox" id="videoBox" style="opacity:0;transform:scale(0.96)">
      <video id="vid" src="${videos[index]}" autoplay loop playsinline></video>

      <div class="topControls">
        <button class="iconBtn" onclick="volverMenu()" title="Volver a emociones">
          <i class="fa-solid fa-arrow-left"></i>
        </button>
        <button class="iconBtn" onclick="location.href='index.html'" title="Inicio">
          <i class="fa-solid fa-house"></i>
        </button>
        <button class="iconBtn" id="btnExpand" onclick="toggleGrande()">
          <i class="fa-solid fa-expand"></i>
        </button>
      </div>

      <div class="videoOverlay">
        <button class="iconBtn" id="btnPlay" onclick="togglePlay()">
          <i class="fa-solid fa-pause"></i>
        </button>
      </div>
    </div>

    <div class="infoPanel">
      <div>
        <h3>Titulo del video</h3>
        <p class="desc">Descripcion del video.</p>
      </div>

      <div class="videoIndicator">${dots}</div>

      <div>
        <p class="comentariosLabel"><i class="fa-solid fa-comment" style="margin-right:5px"></i>Comentarios</p>
        <div class="comentarios" id="listaComents">
          ${renderComents(data)}
        </div>
      </div>

      <input class="comentInput" placeholder="Escribe un comentario y presiona Enter..." onkeypress="guardar(event,'${id}')">

      <div class="volumen">
        <button class="volBtn" onclick="volDown()"><i class="fa-solid fa-minus"></i></button>
        <input id="volBar" type="range" min="0" max="1" step="0.05" value="${volumenActual}" oninput="setVol(this.value)">
        <button class="volBtn" onclick="volUp()"><i class="fa-solid fa-plus"></i></button>
      </div>
    </div>

  </div>`;

  const vid=document.getElementById("vid");
  vid.volume=volumenActual;
  pausado=false;

  const box=document.getElementById("videoBox");
  requestAnimationFrame(()=>{
    box.style.transition="opacity 0.35s ease, transform 0.35s ease";
    box.style.opacity="1";
    box.style.transform="scale(1)";
  });

  if(videoGrande) box.classList.add("grande");
}

/* ---- RENDER COMENTARIOS ---- */
function renderComents(data){
  if(data.length===0) return `<span class="sinComents">Sin comentarios aún...</span>`;
  return data.map((c,i)=>`
    <div class="coment${comentarioSeleccionado===i?' selected':''}" onclick="seleccionar(${i})">
      ${c.text}
      ${comentarioSeleccionado===i?`
      <div class="comentActions">
        <button onclick="event.stopPropagation();likeComentario(${i})">
          <i class="fa-solid fa-heart"></i> ${c.likes}
        </button>
        <button onclick="event.stopPropagation();eliminarComentario(${i})" style="background:var(--danger)">
          <i class="fa-solid fa-trash"></i>
        </button>
      </div>`:''}
    </div>`).join("");
}

/* ---- CAMBIAR VIDEO ---- */
function cambiar(dir){
  const nuevoIndex=index+dir;
  if(nuevoIndex<0||nuevoIndex>=videos.length) return;

  const box=document.getElementById("videoBox");
  box.style.transition="opacity 0.25s ease, transform 0.25s ease";
  box.style.opacity="0";
  box.style.transform=dir>0?"scale(0.96) translateY(12px)":"scale(0.96) translateY(-12px)";

  setTimeout(()=>{
    index=nuevoIndex;
    comentarioSeleccionado=null;
    cargar();
  },260);
}

/* ---- VOLVER AL MENU (DETIENE EL AUDIO) ---- */
function volverMenu(){
  // Pausar y destruir el video antes de ocultar
  const vid=document.getElementById("vid");
  if(vid){
    vid.pause();
    vid.src="";
    vid.load();
  }
  document.getElementById("reels").style.display="none";
  document.getElementById("reels").innerHTML="";
  document.getElementById("menu").style.display="flex";
  comentarioSeleccionado=null;
  pausado=false;
}

/* ---- AGRANDAR VIDEO ---- */
function toggleGrande(){
  videoGrande=!videoGrande;
  document.getElementById("videoBox").classList.toggle("grande",videoGrande);
  const icon=document.querySelector("#btnExpand i");
  icon.className=videoGrande?"fa-solid fa-compress":"fa-solid fa-expand";
}

/* ---- PAUSE / PLAY ---- */
function togglePlay(){
  const vid=document.getElementById("vid");
  const icon=document.querySelector("#btnPlay i");
  if(pausado){
    vid.play(); pausado=false;
    icon.className="fa-solid fa-pause";
  }else{
    vid.pause(); pausado=true;
    icon.className="fa-solid fa-play";
  }
}

/* ---- HELPERS localStorage ---- */
function getComents(id){
  return JSON.parse(localStorage.getItem(id+"_comentarios")||"[]");
}
function saveComents(id,arr){
  localStorage.setItem(id+"_comentarios",JSON.stringify(arr));
}

/* ---- COMENTARIOS ---- */
function guardar(e,id){
  if(e.key==="Enter"){
    const txt=e.target.value.trim();
    if(!txt) return;
    const arr=getComents(id);
    arr.push({text:txt,likes:0});
    saveComents(id,arr);
    e.target.value="";
    comentarioSeleccionado=null;
    actualizarLista(id);
  }
}

function seleccionar(i){
  comentarioSeleccionado=(comentarioSeleccionado===i?null:i);
  actualizarLista("video"+index);
}

function likeComentario(i){
  const id="video"+index;
  const arr=getComents(id);
  arr[i].likes++;
  saveComents(id,arr);
  actualizarLista(id);
}

function eliminarComentario(i){
  const id="video"+index;
  const arr=getComents(id);
  if(confirm("¿Eliminar comentario?")){
    arr.splice(i,1);
    saveComents(id,arr);
    comentarioSeleccionado=null;
    actualizarLista(id);
  }
}

function actualizarLista(id){
  document.getElementById("listaComents").innerHTML=renderComents(getComents(id));
}

/* ---- VOLUMEN ---- */
function setVol(v){
  volumenActual=parseFloat(v);
  const vid=document.getElementById("vid");
  if(vid) vid.volume=volumenActual;
}
function volUp(){
  volumenActual=Math.min(1,volumenActual+0.1);
  setVol(volumenActual);
  const b=document.getElementById("volBar");
  if(b) b.value=volumenActual;
}
function volDown(){
  volumenActual=Math.max(0,volumenActual-0.1);
  setVol(volumenActual);
  const b=document.getElementById("volBar");
  if(b) b.value=volumenActual;
}

</script>

</body>
</html>

